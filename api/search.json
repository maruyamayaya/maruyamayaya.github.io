[{"id":"4c399ed11cf5c6721d172d292920a392","title":"使用LAMMPS FIX PLUMED实现基于分子动力学的增强采样","content":"增强采样与MetaD的基本原理\r\nMetadynamics用于增强分子动力学模拟中的采样，并将自由能表面重构为几个选定自由度的函数，通常称为集体变量(CVs,Collective\r\nVariables)。在Metadynamics中，在CV空间中自适应构造的与历史相关的偏置势可以加速采样，从而对对原始算法进行了显著的改进，高效、灵活和准确等优点使其在多个科学领域发现了许多成功的应用。\r\n事实上，在使用原子经验力场的典型MD模拟中，需要使用飞秒级的时间步长来正确地积分运动方程。而感兴趣的过程往往发生在更长的时间尺度上。从这些考虑来看，MD明显受到时间尺度问题的困扰。人们提出了各种各样的方法来解决这个问题，这些通常被称为增强抽样技术。\r\nMetadynamics属于这样一类方法，通过引入作用于选定自由度的附加偏置势(或力)来促进抽样，通常称为集合变量(CVs)。同时，能够增强采样并重构自由能面(FES)。许多方法也可以被认为属于这一类，最为熟知的是伞形采样。\r\n对于Metadynamics，其偏置势形式为  即高斯函数形式。 经过长时间后，自由能可由如下等式估计：  由  我们就可以作出作为CVs的概率密度分布\r\n通过LAMMPS+PLUMED插件实现增强采样\r\n不会详细介绍LAMMPS安装，教程一抓一大把，请参见LAMMPS官方文档\r\n1.我们获取最新版LAMMPS 和 增强采样软件PLUMED 2.4.0的压缩文件\r\nPLUMED一直在更新，但不是每个版本都能顺利装的上，盲目选最新版可能会因为莫名其妙的报错浪费大量时间\r\n2.解压LAMMPS的压缩文件，进入&lt;解压出的文件&gt;/lib/plumed\r\n目录，把PLUMED压缩文件复制进去并解压,\r\n并且创建个文件夹用来安装,命名为plumed2\r\n\r\n1234cd plumed-2.4.0./configure --prefix=&lt;前面创建的文件夹的绝对路径&gt;make -j 8make install\r\n如果能找到plumed 成功安装的提示就成功了\r\n\r\n4.回到LAMMPS解压出的文件夹，进入src目录 12make lib-plumed args=\"-p &lt;PLUMED安装位置的绝对路径&gt;\"make yes -plumed 再把要用的包\r\n(molecule,rigid,kspace,manybody,extra-dump,extra-fix)\r\n全make yes一遍，就能编译make mpi了\r\n5.使用时，在LAMMPS方面，只需要在.in文件中加上一行fix plumed\r\ncommand,详见LAMMPS官方文档\r\n在PLUMED方面，需要创建plumed.dat脚本文件，以下是一个用局部熵与焓作为CVs，实现Metadynamics的示例\r\n1234567891011121314151617181920212223242526272829303132333435363738394041424344LOAD FILE=../../PairEntropy.cppPAIRENTROPY ... LABEL=s2 ATOMS=1-256 MAXR=0.7 SIGMA=0.0125... PAIRENTROPYENERGY LABEL=eneVOLUME LABEL=volCOMBINE ... ARG=ene,vol POWERS=1,1 COEFFICIENTS=1.,0.060221409 PERIODIC=NO LABEL=enthalpy... COMBINECOMBINE ... ARG=enthalpy POWERS=1 COEFFICIENTS=0.004 PERIODIC=NO LABEL=enthalpyPerAtom... COMBINEMETAD ... LABEL=metad ARG=enthalpyPerAtom,s2 SIGMA=0.2,0.1 HEIGHT=2.5 BIASFACTOR=30 TEMP=325.0 PACE=500 GRID_MIN=-110,-8 GRID_MAX=-90,-1 GRID_BIN=500,500 CALC_RCT... METADPRINT STRIDE=500  ARG=* FILE=COLVAR\r\n其中PairEntropy.cpp为PLUMED官方没有放入官方库中的一个变量脚本，用于生成局部熵。\r\n其余指令不再赘述，见 PLUMED2官方文档\r\n万事俱备后，将你的lammps通过mpi run起来，就可以实现增强采样了。\r\n通过plumed内置的sum_hills程序，就可以计算自由能了。\r\nnohup plumed --no-mpi sum_hills --hills ../HILLS --stride 1000 --mintozero --bin 200,200 &amp;\r\n","slug":"lammps-plumed","date":"2024-11-23T08:07:47.000Z","categories_index":"软件使用","tags_index":"分子动力学,增强采样,LAMMPS,PLUMED","author_index":"Aya"},{"id":"51d6d1f844c6f91aced8e20d878c6c52","title":"欢迎来到我的博客捏","content":"一个不认真学物理的物理人。\r\n\r\n","slug":"welcome","date":"2024-11-22T11:55:04.000Z","categories_index":"首页","tags_index":"welcome","author_index":"Aya"},{"id":"7933319b50bcad437c2b4fcd0161988d","title":"LC Knight纪念","content":"在过去的一个月打了六场周赛之后，LC\r\nRating终于堪堪突破1900,也算是涨得蛮快？至少对于我这个几乎没什么基础的人来说。\r\n\r\n","slug":"lcknight","date":"2024-11-21T11:31:13.000Z","categories_index":"随写","tags_index":"Leetcode","author_index":"Aya"},{"id":"8797a8d50d3e1878035b7a2cdde5a1f8","title":"矢量分析公式推导逃课大法","content":"本意是想试试 Markdown 和 \r\n语法，不小心就把整篇打完了（逃\r\n一、爱因斯坦求和约定\r\n为简化计算，下文所有含下标公式均采用爱因斯坦求和约定：\r\n1.在同一项中，如果同一指标成对出现，就表示遍历其取值范围求和。这时求和符号可以省略。\r\n2.成对出现的指标叫做哑指标，简称哑标。表示哑标的小写字母可以用另一对小写字母替换，只要其取值范围不变。\r\n3.当两个求和式相乘时，两个求和式的哑标不能使用相同的小写字母。为了避免混乱，常用的办法是根据上一条规则，先将其中一个求和式的哑标改换成其它小写字母。\r\n例如: \r\n二、Levi-Civita与Kronecker记号\r\n先引入两个著名的记号\r\nKronecker记号: \r\nLevi-Civita记号： 两两不同逆序数为偶数两两不同逆序数为奇数其他情况\r\n借助Levi-Civita记号，我们可以这样表达叉积的分量形式： \r\n好了，想必你已经全都懂了！现在我们来推导几个公式！\r\n三、几个常见公式的推导\r\n为了简便（懒得打），我们记 \r\n混合积公式\r\n 证明：   由Levi-Civita轮换对称性  得证\r\n标量与矢量相乘求旋度\r\n 证明: \r\n叉积的散度\r\n\r\n梯无旋,旋无散\r\n\r\n由Levi-Civita记号反对称性与偏导数可交换顺序得值为0，旋度的散度同理\r\n为了解决一些有两个叉乘的情况，我们需要用到下面的公式:  顺便提一下这两个很trival但很有用的式子:  \r\n矢量三重积公式(坐出租回家)\r\n\r\n证明： \r\n旋度的旋度\r\n\r\n总之，这一方法可以避免复杂的展开计算，对于我们克服对复杂矢量计算的恐惧很有帮助\r\n","slug":"firstblog","date":"2024-11-10T10:29:53.000Z","categories_index":"数学物理方法","tags_index":"矢量分析","author_index":"Aya"}]